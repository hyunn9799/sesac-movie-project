<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MovieHub - ì¸ì¦ ë° ìƒíƒœ í˜ì´ì§€ (ìµœì¢…)</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      * { box-sizing: border-box; }
      body { margin: 0; padding: 0; background-color: #141414; font-family: "Arial", sans-serif; }
      a { cursor: pointer; text-decoration: none; }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // ========== ìŠ¤íƒ€ì¼ í† í° ==========
      const colors = {
        primary: "#E50914", secondary: "#B20710", dark: "#141414", darkGray: "#2F2F2F",
        mediumGray: "#808080", lightGray: "#E5E5E5", white: "#FFFFFF", yellow: "#F5C518",
        success: "#4CAF50", warning: "#FF9800", error: "#F44336", info: "#2196F3",
        textPrimary: "#FFFFFF", textSecondary: "#808080", textLight: "#999999"
      };
      const spacing = { xs: "4px", sm: "8px", md: "16px", lg: "24px", xl: "32px", xxl: "48px" };
      const fontSize = { small: "12px", medium: "14px", large: "16px", xlarge: "20px", xxlarge: "24px", title: "32px" };
      const fontWeight = { normal: 400, bold: 700 };
      const borderRadius = { small: "4px", medium: "8px", large: "12px" };
      const shadow = { header: '0 2px 8px rgba(0,0,0,0.3)' }; 

      // ì˜í™” ì¥ë¥´ ëª©ë¡
      const movieGenres = ['ì•¡ì…˜', 'ì½”ë¯¸ë””', 'ë“œë¼ë§ˆ', 'ìŠ¤ë¦´ëŸ¬', 'ë¡œë§¨ìŠ¤', 'SF', 'ê³µí¬', 'ì• ë‹ˆë©”ì´ì…˜'];

      // ========== ê³µí†µ ìŠ¤íƒ€ì¼ í•¨ìˆ˜ ==========
      const getButtonStyle = (backgroundColor, color) => ({
          backgroundColor: backgroundColor, 
          color: color, 
          padding: `${spacing.sm} ${spacing.lg}`, 
          border: "none", 
          borderRadius: borderRadius.small, 
          cursor: "pointer", 
          fontSize: fontSize.medium, 
          fontWeight: fontWeight.bold
      });
      
      // ========== í—¤ë” ì»´í¬ë„ŒíŠ¸ ==========
      function Header({ isLoggedIn, onLoginClick, onRegisterClick, onLogoutAttempt }) {
        const [searchTerm, setSearchTerm] = useState('');
        
        const headerStyle = {
            backgroundColor: colors.dark,
            padding: `${spacing.md} ${spacing.xl}`,
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            boxShadow: shadow.header,
            position: 'fixed',
            top: 0,
            left: 0,
            right: 0,
            zIndex: 999
        };
        
        const logoStyle = {
            fontSize: fontSize.xxlarge,
            color: colors.primary,
            fontWeight: fontWeight.bold,
            margin: 0
        };
        
        const searchInputStyle = {
            padding: spacing.sm,
            borderRadius: borderRadius.small,
            border: `1px solid ${colors.mediumGray}`,
            backgroundColor: colors.darkGray,
            color: colors.white,
            width: '250px',
            fontSize: fontSize.medium,
        };

        return (
            <div style={headerStyle}>
                <h1 style={logoStyle}>ğŸ¬ MovieHub</h1>
                <div style={{ display: 'flex', alignItems: 'center', gap: spacing.md }}>
                    <input
                        type="text"
                        placeholder="ì˜í™”, ê°ë…, ë°°ìš° ê²€ìƒ‰..."
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                        style={searchInputStyle}
                    />
                    
                    {isLoggedIn ? (
                        <>
                            <button style={getButtonStyle(colors.darkGray, colors.white)}>ë§ˆì´í˜ì´ì§€</button>
                            <button onClick={onLogoutAttempt} style={getButtonStyle(colors.primary, colors.white)}>ë¡œê·¸ì•„ì›ƒ</button>
                        </>
                    ) : (
                        <>
                            <button onClick={onLoginClick} style={getButtonStyle(colors.primary, colors.white)}>ë¡œê·¸ì¸</button>
                            <button onClick={onRegisterClick} style={getButtonStyle(colors.darkGray, colors.white)}>íšŒì›ê°€ì…</button>
                        </>
                    )}
                </div>
            </div>
        );
      }
      
      // ========== ëª¨ë‹¬ (ì„±ê³µ/ì‹¤íŒ¨ ì•Œë¦¼) ==========
      function Modal({ modal, closeModal }) {
        if (!modal.isVisible) return null;
        let headerText = "", headerColor = "";
        if (modal.type === "success") { headerText = "âœ”"; headerColor = colors.success; }
        else if (modal.type === "error") { headerText = "â—"; headerColor = colors.error; }
        else if (modal.type === "warning") { headerText = "âš "; headerColor = colors.warning; }
        
        return (
          <div style={{ position: "fixed", top: 0, left: 0, right: 0, bottom: 0, backgroundColor: "rgba(0,0,0,0.7)", display: "flex", justifyContent: "center", alignItems: "center", zIndex: 1000 }}>
            <div style={{ backgroundColor: colors.darkGray, padding: spacing.xl, borderRadius: borderRadius.medium, width: "350px", textAlign: "center", color: colors.white }}>
              <div style={{ fontSize: fontSize.xxlarge, marginBottom: spacing.md, fontWeight: fontWeight.bold, color: headerColor }}>{headerText}</div>
              <p style={{ whiteSpace: "pre-wrap", margin: 0, fontSize: fontSize.large, lineHeight: 1.6 }}>{modal.message}</p>
              <button onClick={closeModal} style={getButtonStyle(headerColor, colors.white)}>í™•ì¸</button>
            </div>
          </div>
        );
      }

      // ========== í™•ì¸ ëª¨ë‹¬ (ì˜ˆ/ì•„ë‹ˆì˜¤) ==========
      function ConfirmModal({ modal, onConfirm, onCancel }) {
        if (!modal.isVisible) return null;
        return (
          <div style={{ position: "fixed", top: 0, left: 0, right: 0, bottom: 0, backgroundColor: "rgba(0,0,0,0.7)", display: "flex", justifyContent: "center", alignItems: "center", zIndex: 1000 }}>
            <div style={{ backgroundColor: colors.darkGray, padding: spacing.xl, borderRadius: borderRadius.medium, width: "300px", textAlign: "center", color: colors.white }}>
              <p style={{ margin: 0, fontSize: fontSize.xlarge, marginBottom: spacing.lg, fontWeight: fontWeight.bold }}>{modal.message}</p>
              <div style={{ display: "flex", gap: spacing.md, justifyContent: "center" }}>
                <button onClick={onConfirm} style={getButtonStyle(colors.primary, colors.white)}>{modal.confirmText || 'í™•ì¸'}</button>
                <button onClick={onCancel} style={getButtonStyle(colors.mediumGray, colors.white)}>{modal.cancelText || 'ì·¨ì†Œ'}</button>
              </div>
            </div>
          </div>
        );
      }

      // ========== ë¡œê·¸ì¸ í¼ ==========
      function LoginForm({ onLoginSuccess, onNavigateRegister }) {
        const [id, setId] = useState("");
        const [password, setPassword] = useState("");
        const [formError, setFormError] = useState("");
        
        const handleSubmit = (e) => {
          e.preventDefault();
          setFormError("");
          if (!id || !password) { setFormError("ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }
          
          if (id === "test" && password === "1234") {
            onLoginSuccess(id);
          } else if (id === "test") {
            setFormError("ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
          } else {
            setFormError("ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
          }
        };
        
        const inputStyle = { width: "100%", backgroundColor: colors.darkGray, border: `1px solid ${colors.mediumGray}`, color: colors.white, padding: spacing.md, marginBottom: spacing.lg, marginTop: spacing.xs, borderRadius: borderRadius.small };
        const buttonStyle = { width: "100%", backgroundColor: colors.primary, color: colors.white, fontSize: fontSize.large, padding: spacing.md, border: "none", borderRadius: borderRadius.small, cursor: "pointer" };
        
        return (
          <div>
            <h2 style={{ textAlign: "center", color: colors.white, marginBottom: spacing.xl, fontSize: fontSize.title }}>ë¡œê·¸ì¸</h2>
            {formError && (
              <div style={{ backgroundColor: colors.error, color: colors.white, padding: spacing.lg, borderRadius: borderRadius.small, marginBottom: spacing.lg, textAlign: "center" }}>
                <p style={{ margin: 0, fontSize: fontSize.large, fontWeight: fontWeight.bold }}>â— {formError}</p>
              </div>
            )}
            <form onSubmit={handleSubmit}>
              <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ì•„ì´ë””</label>
              <input type="text" value={id} onChange={(e) => setId(e.target.value)} placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”." style={inputStyle} />
              <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ë¹„ë°€ë²ˆí˜¸</label>
              <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”." style={inputStyle} />
              <button type="submit" style={buttonStyle}>ë¡œê·¸ì¸</button>
            </form>
            <div style={{ marginTop: spacing.xl, textAlign: "center" }}>
              <a onClick={onNavigateRegister} style={{ color: colors.mediumGray, textDecoration: "none", display: "block", marginBottom: spacing.sm }}>íšŒì›ê°€ì…</a>
              <a href="#" style={{ color: colors.mediumGray, textDecoration: "none", display: "block" }}>ì•„ì´ë”” / ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
            </div>
          </div>
        );
      }

      // ========== íšŒì›ê°€ì… í¼ (ìˆ˜ì •ë¨) ==========
      function RegisterForm({ onRegisterSuccess, onNavigateLogin }) {
        const [step, setStep] = useState(1);
        const [terms, setTerms] = useState({ term1: false, term2: false, term3: false });
        const [allChecked, setAllChecked] = useState(false);
        const [formData, setFormData] = useState({ 
            id: "", 
            password: "", 
            passwordConfirm: "", // ğŸ‘ˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì¶”ê°€
            name: "", 
            email: "", 
            phone: "",          // ğŸ‘ˆ ì „í™”ë²ˆí˜¸ ì¶”ê°€
            likedGenres: [],    // ğŸ‘ˆ ì¢‹ì•„í•˜ëŠ” ì¥ë¥´
            dislikedGenres: []  // ğŸ‘ˆ ì‹«ì–´í•˜ëŠ” ì¥ë¥´ ì¶”ê°€
        });
        const [formError, setFormError] = useState("");
        
        useEffect(() => { setAllChecked(terms.term1 && terms.term2 && terms.term3); }, [terms]);
        const handleCheckAll = (e) => { const checked = e.target.checked; setTerms({ term1: checked, term2: checked, term3: checked }); };
        const handleTermCheck = (name) => { setTerms(prev => ({ ...prev, [name]: !prev[name] })); };
        
        const handleGenreToggle = (genre, type) => {
            const field = type === 'like' ? 'likedGenres' : 'dislikedGenres';
            setFormData(prev => {
                const genres = prev[field].includes(genre) 
                    ? prev[field].filter(g => g !== genre) 
                    : [...prev[field], genre];
                return { ...prev, [field]: genres };
            });
        };
        
        const handleNextStep = () => {
          if (!terms.term1 || !terms.term2) { setFormError("í•„ìˆ˜ ì•½ê´€ì— ë™ì˜í•´ì•¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."); return; }
          setFormError("");
          setStep(2);
        };
        
        const handleInputChange = (e) => setFormData({ ...formData, [e.target.name]: e.target.value });
        
        const handleRegisterSubmit = (e) => {
          e.preventDefault();
          
          if (formData.password !== formData.passwordConfirm) {
              setFormError("ë¹„ë°€ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
              return;
          }
          if (formData.likedGenres.length === 0) { setFormError("ì¢‹ì•„í•˜ëŠ” ì˜í™” ì¥ë¥´ë¥¼ ìµœì†Œ 1ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
          if (formData.dislikedGenres.length === 0) { setFormError("ì‹«ì–´í•˜ëŠ” ì˜í™” ì¥ë¥´ë¥¼ ìµœì†Œ 1ê°œ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”."); return; }
          
          onRegisterSuccess(formData.id, formData.likedGenres);
        };
        
        const inputStyle = { width: "100%", backgroundColor: colors.darkGray, border: `1px solid ${colors.mediumGray}`, color: colors.white, padding: spacing.md, marginBottom: spacing.lg, marginTop: spacing.xs, borderRadius: borderRadius.small };
        const buttonPrimary = { width: "100%", backgroundColor: colors.primary, color: colors.white, fontSize: fontSize.large, padding: spacing.md, marginBottom: spacing.md, border: "none", borderRadius: borderRadius.small, cursor: "pointer" };
        const buttonSecondary = { width: "100%", backgroundColor: colors.darkGray, border: `1px solid ${colors.mediumGray}`, color: colors.white, fontSize: fontSize.large, padding: spacing.md, borderRadius: borderRadius.small, cursor: "pointer" };
        const termBox = { border: `1px solid ${colors.mediumGray}`, padding: spacing.md, borderRadius: borderRadius.small, marginBottom: spacing.sm, backgroundColor: colors.dark };
        const checkboxStyle = { marginRight: spacing.sm, width: "18px", height: "18px", cursor: "pointer" };
        
        return (
          <div>
            <h2 style={{ textAlign: "center", color: colors.white, marginBottom: spacing.xl, fontSize: fontSize.title }}>íšŒì›ê°€ì…</h2>
            
            {step === 1 && (
              <div>
                <p style={{ textAlign: "center", fontSize: fontSize.xlarge, marginBottom: spacing.md, color: colors.white }}>ì•½ê´€ ë™ì˜</p>
                <div style={{ marginBottom: spacing.lg, padding: spacing.md, backgroundColor: colors.darkGray, borderRadius: borderRadius.small }}>
                  <label style={{ display: "flex", alignItems: "center", fontWeight: fontWeight.bold, color: colors.white, cursor: "pointer" }}>
                    <input type="checkbox" checked={allChecked} onChange={handleCheckAll} style={checkboxStyle} />
                    <span>ì „ì²´ ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤.</span>
                  </label>
                </div>
                {[ { key: 'term1', text: '(í•„ìˆ˜) ì´ìš© ì•½ê´€ ë™ì˜', required: true }, { key: 'term2', text: '(í•„ìˆ˜) ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜', required: true }, { key: 'term3', text: '(ì„ íƒ) ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹  ë™ì˜', required: false } ].map((term) => (
                  <div key={term.key} style={termBox}>
                    <label style={{ display: "flex", alignItems: "center", color: colors.white, cursor: "pointer" }}>
                      <input type="checkbox" checked={terms[term.key]} onChange={() => handleTermCheck(term.key)} style={{ marginRight: spacing.sm, width: "16px", height: "16px", cursor: "pointer" }}/>
                      <span>{term.text}</span>
                    </label>
                  </div>
                ))}
                {formError && <p style={{ color: colors.error, textAlign: "center", margin: `${spacing.md} 0` }}>{formError}</p>}
                <button style={buttonPrimary} onClick={handleNextStep}>ë‹¤ìŒ ë‹¨ê³„</button>
                <button style={buttonSecondary} onClick={onNavigateLogin}>ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</button>
              </div>
            )}
            
            {step === 2 && (
              <form onSubmit={handleRegisterSubmit}>
                <p style={{ textAlign: "center", fontSize: fontSize.xlarge, marginBottom: spacing.md, color: colors.white }}>íšŒì› ì •ë³´ ì…ë ¥</p>
                
                {/* 1. ì´ë©”ì¼ ì…ë ¥ë€ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ì´ë©”ì¼</label>
                <input name="email" type="email" value={formData.email} onChange={handleInputChange} placeholder="example@moviehub.com" style={inputStyle} />

                {/* 2. ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ë€ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ë¹„ë°€ë²ˆí˜¸ (8ì ì´ìƒ)</label>
                <input name="password" type="password" value={formData.password} onChange={handleInputChange} style={inputStyle} />
                
                {/* 3. ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì…ë ¥ë€ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                <input name="passwordConfirm" type="password" value={formData.passwordConfirm} onChange={handleInputChange} style={inputStyle} />
                
                {/* 4. ì´ë¦„ ì…ë ¥ë€ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ì´ë¦„</label>
                <input name="name" type="text" value={formData.name} onChange={handleInputChange} style={inputStyle} />
                
                {/* 5. ì „í™”ë²ˆí˜¸ ì…ë ¥ë€ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight }}>ì „í™”ë²ˆí˜¸</label>
                <input name="phone" type="tel" value={formData.phone} onChange={handleInputChange} placeholder="010-0000-0000" style={inputStyle} />

                {/* 6. ì¢‹ì•„í•˜ëŠ” ì˜í™” ì¥ë¥´ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight, marginTop: spacing.md, marginBottom: spacing.sm }}>ì¢‹ì•„í•˜ëŠ” ì˜í™” ì¥ë¥´ (í•„ìˆ˜)</label>
                <div style={{ display: "grid", gridTemplateColumns: "repeat(2, 1fr)", gap: spacing.sm, marginBottom: spacing.lg }}>
                  {movieGenres.map(genre => (
                    <label key={genre} style={{ display: "flex", alignItems: "center", color: colors.white, cursor: "pointer", backgroundColor: colors.darkGray, padding: spacing.sm, borderRadius: borderRadius.small }}>
                      <input type="checkbox" checked={formData.likedGenres.includes(genre)} onChange={() => handleGenreToggle(genre, 'like')} style={{ marginRight: spacing.sm, width: "16px", height: "16px", cursor: "pointer" }}/>
                      <span>{genre}</span>
                    </label>
                  ))}
                </div>

                {/* 7. ì‹«ì–´í•˜ëŠ” ì˜í™” ì¥ë¥´ */}
                <label style={{ display: "block", fontSize: fontSize.medium, color: colors.textLight, marginTop: spacing.md, marginBottom: spacing.sm }}>ì‹«ì–´í•˜ëŠ” ì˜í™” ì¥ë¥´ (í•„ìˆ˜)</label>
                <div style={{ display: "grid", gridTemplateColumns: "repeat(2, 1fr)", gap: spacing.sm, marginBottom: spacing.lg }}>
                  {movieGenres.map(genre => (
                    <label key={genre} style={{ display: "flex", alignItems: "center", color: colors.white, cursor: "pointer", backgroundColor: colors.darkGray, padding: spacing.sm, borderRadius: borderRadius.small }}>
                      <input type="checkbox" checked={formData.dislikedGenres.includes(genre)} onChange={() => handleGenreToggle(genre, 'dislike')} style={{ marginRight: spacing.sm, width: "16px", height: "16px", cursor: "pointer" }}/>
                      <span>{genre}</span>
                    </label>
                  ))}
                </div>

                {formError && <p style={{ color: colors.error, textAlign: "center", margin: `${spacing.md} 0` }}>{formError}</p>}
                <button type="submit" style={buttonPrimary}>íšŒì›ê°€ì… ì™„ë£Œ</button>
                <button type="button" style={buttonSecondary} onClick={() => setStep(1)}>ì´ì „ ë‹¨ê³„</button>
              </form>
            )}
          </div>
        );
      }


      // ========== ë¡œê·¸ì¸ í›„ ë©”ì¸ í™”ë©´ (ì„ì‹œ) ==========
      function MainPage({ username, onLogout, onWithdraw }) {
        return (
          <div style={{ textAlign: "center", color: colors.white, paddingTop: spacing.xxl }}>
            <div style={{ backgroundColor: colors.darkGray, padding: spacing.xxl, borderRadius: borderRadius.medium, marginBottom: spacing.xl }}>
              <p style={{ fontSize: fontSize.xlarge, margin: 0, fontWeight: fontWeight.bold }}>{username}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</p>
            </div>
            <button onClick={onLogout} style={getButtonStyle(colors.primary, colors.white)} >ë¡œê·¸ì•„ì›ƒ</button>
            <button onClick={onWithdraw} style={getButtonStyle(colors.error, colors.white)} >íšŒì› íƒˆí‡´</button>
          </div>
        );
      }


      // ========== ë¡œê·¸ì•„ì›ƒ ì„±ê³µ í˜ì´ì§€ ==========
      function LogoutSuccessPage({ onReturnToLogin }) {
        return (
          <div style={{ textAlign: "center", color: colors.white, paddingTop: spacing.xxl }}>
            <div style={{ backgroundColor: colors.success, padding: spacing.xxl, borderRadius: borderRadius.medium, marginBottom: spacing.xl }}>
              <p style={{ fontSize: fontSize.xlarge, margin: 0, fontWeight: fontWeight.bold, color: colors.white }}>âœ” ë¡œê·¸ì•„ì›ƒì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤!</p>
            </div>
            <button onClick={onReturnToLogin} style={getButtonStyle(colors.primary, colors.white)}>ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™</button>
          </div>
        );
      }


      // ========== ë©”ì¸ ì•± (ì¸ì¦ ìƒíƒœ ê´€ë¦¬) ==========
      function AuthPage() {
        const [isLoggedIn, setIsLoggedIn] = useState(false);
        const [page, setPage] = useState("login");
        const [username, setUsername] = useState("");
        const [modal, setModal] = useState({ isVisible: false, type: "", message: "" });
        const [confirmModal, setConfirmModal] = useState({ isVisible: false, message: "", action: "" });
        
        const openModal = (type, message) => setModal({ isVisible: true, type, message });
        const closeModal = () => {
          if (modal.type === 'success' && page === 'register') { setPage("login"); }
          setModal({ isVisible: false, type: "", message: "" });
        };

        const handleLoginSuccess = (id) => {
          setUsername(id);
          setIsLoggedIn(true); 
          openModal("success", `${id}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`); 
          setPage("main");
        };
        
        const handleRegisterSuccess = (id, genres) => {
          openModal("success", `íšŒì›ê°€ì…ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤!\nì•„ì´ë””: ${id}\n\ní™•ì¸ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.`);
        };
        
        const handleLogoutAttempt = () => {
          setConfirmModal({ isVisible: true, message: "ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?", action: "logout" });
        };
        
        const confirmLogout = () => {
          setConfirmModal({ isVisible: false, message: "", action: "" });
          setIsLoggedIn(false); 
          setUsername("");
          setPage("logoutSuccess"); 
        };
        
        const handleWithdrawAttempt = () => {
          setConfirmModal({ isVisible: true, message: "íšŒì›íƒˆí‡´ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?", action: "withdraw", confirmText: 'íƒˆí‡´', cancelText: 'ì·¨ì†Œ' });
        };
        
        const confirmWithdraw = () => {
          setConfirmModal({ isVisible: false, message: "", action: "" });
          setIsLoggedIn(false); 
          setUsername("");
          openModal("success", "íšŒì› íƒˆí‡´ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.\nê·¸ë™ì•ˆ ì´ìš©í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤.");
          setPage("login");
        };
        
        const handleConfirm = () => {
          if (confirmModal.action === "logout") {
            confirmLogout();
          } else if (confirmModal.action === "withdraw") {
            confirmWithdraw();
          }
        };
        
        const handleCancel = () => setConfirmModal({ isVisible: false, message: "", action: "" });
        
        const containerStyle = { 
            minHeight: "100vh", 
            backgroundColor: colors.dark, 
            color: colors.white, 
            display: "flex", 
            justifyContent: "center", 
            alignItems: "center", 
            padding: spacing.xl,
            paddingTop: `calc(${spacing.xl} + 60px)`
        };
        const boxStyle = { width: "100%", maxWidth: "450px", padding: spacing.xl, backgroundColor: colors.darkGray, borderRadius: borderRadius.medium, boxShadow: "0 8px 16px rgba(0,0,0,0.2)" };
        
        return (
          <>
            <Header 
                isLoggedIn={isLoggedIn}
                onLoginClick={() => setPage("login")}
                onRegisterClick={() => setPage("register")}
                onLogoutAttempt={handleLogoutAttempt}
            />

            <div style={containerStyle}>
                <div style={boxStyle}>
                  {page === "login" && <LoginForm onLoginSuccess={handleLoginSuccess} onNavigateRegister={() => setPage("register")} />}
                  {page === "register" && <RegisterForm onRegisterSuccess={handleRegisterSuccess} onNavigateLogin={() => setPage("login")} />}
                  {page === "main" && <MainPage username={username} onLogout={handleLogoutAttempt} onWithdraw={handleWithdrawAttempt} />}
                  {page === "logoutSuccess" && <LogoutSuccessPage onReturnToLogin={() => setPage("login")} />}
                </div>
            </div>
            
            <Modal modal={modal} closeModal={closeModal} />
            <ConfirmModal modal={confirmModal} onConfirm={handleConfirm} onCancel={handleCancel} />
          </>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<AuthPage />);
    </script>
  </body>
</html>